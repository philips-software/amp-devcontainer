---
active: true
derived: false
level: 2.4
links: []
normative: true
ref: ''
reviewed: null
---

``` {.sh #testcase}
# bats test_tags=tc:TEST-0004
@test "using ccache as a compiler launcher should result in cached build" {
  run ccache --clear --zero-stats

  run cmake --preset gcc -DCMAKE_C_COMPILER_LAUNCHER=ccache -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
  assert_success

  run cmake --build --preset gcc
  assert_success

  run ccache -s
  assert_output --partial "Hits:               0"
  assert_output --partial "Misses:             1"

  run rm -rf build
  run ccache --zero-stats

  run cmake --preset gcc -DCMAKE_C_COMPILER_LAUNCHER=ccache -DCMAKE_CXX_COMPILER_LAUNCHER=ccache
  assert_success

  run cmake --build --preset gcc
  assert_success

  run ccache -s
  assert_output --partial "Hits:               1"
  assert_output --partial "Misses:             0"
}
```